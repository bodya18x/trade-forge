# üöÄ Trade Forge Logger - –ü–æ–Ω—è—Ç–Ω–æ–µ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ

## ü§î –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –æ–≥—Ä–æ–º–Ω–∞—è –∫—É—Ö–Ω—è (–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Trade Forge), –≥–¥–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–µ—Å—è—Ç–∫–∏ –ø–æ–≤–∞—Ä–æ–≤ (—Å–µ—Ä–≤–∏—Å–æ–≤). –ö–∞–∂–¥—ã–π –ø–æ–≤–∞—Ä –¥–µ–ª–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É: –æ–¥–∏–Ω —Ä–µ–∂–µ—Ç –æ–≤–æ—â–∏, –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏—Ç —Å—É–ø, —Ç—Ä–µ—Ç–∏–π –ø–µ—á–µ—Ç —Ö–ª–µ–±.

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ (–ø–µ—Ä–µ—Å–æ–ª–∏–ª–∏ —Å—É–ø), –∫–∞–∫ –ø–æ–Ω—è—Ç—å –∫—Ç–æ –≤–∏–Ω–æ–≤–∞—Ç –∏ –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ? –ö–∞–∂–¥—ã–π –ø–æ–≤–∞—Ä –ø—Ä–æ—Å—Ç–æ –∫—Ä–∏—á–∏—Ç "–£ –º–µ–Ω—è –≤—Å—ë –æ–∫!" –∏–ª–∏ "–ß—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å!" –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** `tradeforge_logger` ‚Äî —ç—Ç–æ **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è + –∞—É–¥–∏–æ–∑–∞–ø–∏—Å–∏** –¥–ª—è —Ç–≤–æ–µ–π –∫—É—Ö–Ω–∏. –¢–µ–ø–µ—Ä—å:
- ‚úÖ –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –≤–µ—Å—å –ø—É—Ç—å –∑–∞–∫–∞–∑–∞ (correlation_id)
- ‚úÖ –õ–æ–≥–∏ –Ω–µ "–∫—Ä–∏—á–∞—Ç —Ö–∞–æ—Ç–∏—á–Ω–æ", –∞ –≥–æ–≤–æ—Ä—è—Ç —á–µ—Ç–∫–æ: **–ö–¢–û, –ß–¢–û, –ö–û–ì–î–ê, –ü–û–ß–ï–ú–£**
- ‚úÖ –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
- ‚úÖ –í production ‚Äî –º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–π JSON, –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π —Ü–≤–µ—Ç–Ω–æ–π —Ç–µ–∫—Å—Ç

---

## üéØ –ì–ª–∞–≤–Ω—ã–µ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1Ô∏è‚É£ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–î–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–ø–ª–æ—Ö–æ):**
```python
print(f"Order created: {order_id}, amount: {amount}, user: {user_id}")
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# Order created: ORD-123, amount: 100.50, user: user_789
```

‚ùå **–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–∫–∞–∑—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–µ–ª—å–∑—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
- –ù–µ—Ç timestamp, –Ω–µ—Ç —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π (—Ö–æ—Ä–æ—à–æ):**
```python
logger.info("order.created", order_id="ORD-123", amount=100.50, user_id="user_789")
```

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ production (JSON):**
```json
{
  "timestamp": "2025-10-20T14:23:45.123456Z",
  "level": "info",
  "event": "order.created",
  "service": "order-service",
  "environment": "production",
  "order_id": "ORD-123",
  "amount": 100.50,
  "user_id": "user_789"
}
```

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ development (Console):**
```
2025-10-20 14:23:45.123 [INFO    ] order.created
    order_id: ORD-123
    amount: 100.50
    user_id: user_789
```

**–ß—Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º?**
- üîç –ú–æ–∂–µ–º –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `grep "user_789" logs.json`
- üìä –ú–æ–∂–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤ —Å–æ–∑–¥–∞–Ω–æ –∑–∞ –¥–µ–Ω—å
- üïê –¢–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
- üìà –ú–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Elasticsearch/Kibana –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

### 2Ô∏è‚É£ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ß–µ—Ä–µ–∑ –í—Å–µ –°–µ—Ä–≤–∏—Å—ã (Correlation ID)**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ ‚Üí —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å ‚Üí —Å–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ–Ω—å–≥–∏ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
–ó–∞–∫–∞–∑ –ø—Ä–æ—à–µ–ª —á–µ—Ä–µ–∑ 4 —Å–µ—Ä–≤–∏—Å–∞. –ì–¥–µ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å. –ö–∞–∫ –ø–æ–Ω—è—Ç—å –≥–¥–µ –∏–º–µ–Ω–Ω–æ? –¢—ã —Å–º–æ—Ç—Ä–∏—à—å –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, –ø—ã—Ç–∞—è—Å—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ ‚Äî **—ç—Ç–æ –∞–¥**.

**–†–µ—à–µ–Ω–∏–µ —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**

**External API (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞):**
```python
@app.post("/orders")
async def create_order(request: Request):
    # Middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç correlation_id
    logger.info("order.creation.started", amount=100.50)
    # correlation_id: "550e8400-e29b-41d4-a716-446655440000"
```

**Order Service:**
```python
logger.info("validating.order", order_id="ORD-123")
# correlation_id: "550e8400-e29b-41d4-a716-446655440000"
```

**Payment Service:**
```python
logger.info("charging.payment", amount=100.50)
# correlation_id: "550e8400-e29b-41d4-a716-446655440000"
```

**Notification Service:**
```python
logger.info("sending.notification", type="email")
# correlation_id: "550e8400-e29b-41d4-a716-446655440000"
```

**–ß—Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º?**
–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –∏—â–µ–º –ø–æ `correlation_id`:
```bash
grep "550e8400-e29b-41d4-a716-446655440000" logs/*.json
```

–ò –≤–∏–¥–∏–º **–≤–µ—Å—å –ø—É—Ç—å –∑–∞–∫–∞–∑–∞** —á–µ—Ä–µ–∑ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã! üéâ

---

### 3Ô∏è‚É£ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ó–∞—â–∏—Ç–∞ –°–µ–∫—Ä–µ—Ç–æ–≤ (Sanitization)**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–ª—É—á–∞–π–Ω–æ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ë–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
```python
logger.info(f"User logged in: {username}, password: {password}")
# User logged in: john_doe, password: SuperSecret123!
```

‚ùå **–ü–∞—Ä–æ–ª—å –≤ –ª–æ–≥–∞—Ö = —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

**–° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**
```python
logger.info("user.logged.in", username="john_doe", password="SuperSecret123!")
```

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "event": "user.logged.in",
  "username": "john_doe",
  "password": "[REDACTED]"
}
```

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç:**
- `password`, `token`, `secret`, `api_key`
- `authorization`, `bearer`, `access_token`
- `credit_card`, `cvv`, `ssn`, `passport`
- –ò –ª—é–±—ã–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã —É–∫–∞–∂–µ—à—å

---

### 4Ô∏è‚É£ **–ö–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî –ò–∑–±–∞–≤–ª—è–µ–º—Å—è –æ—Ç –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
logger.info("step_1", user_id="user_789", order_id="ORD-123")
logger.info("step_2", user_id="user_789", order_id="ORD-123")
logger.info("step_3", user_id="user_789", order_id="ORD-123")
# –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –¥—É–±–ª–∏—Ä—É–µ–º user_id –∏ order_id üò´
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
with bind_context(user_id="user_789", order_id="ORD-123"):
    logger.info("step.1")
    logger.info("step.2")
    logger.info("step.3")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{"event": "step.1", "user_id": "user_789", "order_id": "ORD-123"}
{"event": "step.2", "user_id": "user_789", "order_id": "ORD-123"}
{"event": "step.3", "user_id": "user_789", "order_id": "ORD-123"}
```

**–í—Å–µ –ª–æ–≥–∏ –≤–Ω—É—Ç—Ä–∏ `with` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç `user_id` –∏ `order_id`!**

---

### 5Ô∏è‚É£ **FastAPI –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî –õ–æ–≥–∏—Ä—É–µ–º HTTP –ó–∞–ø—Ä–æ—Å—ã –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

**–ë–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
–¢—ã –≤—Ä—É—á–Ω—É—é –ª–æ–≥–∏—Ä—É–µ—à—å –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å:
```python
@app.get("/orders/{order_id}")
async def get_order(order_id: str):
    logger.info(f"Request GET /orders/{order_id}")
    # ... –ª–æ–≥–∏–∫–∞
    logger.info(f"Response 200 /orders/{order_id}")
```

üò´ –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å —ç—Ç–æ –≤ **–∫–∞–∂–¥–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ**.

**–° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**
```python
from tradeforge_logger.middleware import RequestContextMiddleware, LoggingMiddleware

app = FastAPI()
app.add_middleware(RequestContextMiddleware)  # –î–æ–±–∞–≤–ª—è–µ—Ç correlation_id, request_id
app.add_middleware(LoggingMiddleware)  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

@app.get("/orders/{order_id}")
async def get_order(order_id: str):
    logger.info("fetching.order", order_id=order_id)
    return {"order_id": order_id}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?**

**–í—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å:**
```json
{
  "event": "http.request.received",
  "method": "GET",
  "path": "/orders/ORD-123",
  "client_host": "192.168.1.100",
  "request_id": "req_7f8b9c123",
  "correlation_id": "550e8400..."
}
```

**–¢–≤–æ–π –ª–æ–≥:**
```json
{
  "event": "fetching.order",
  "order_id": "ORD-123",
  "request_id": "req_7f8b9c123",
  "correlation_id": "550e8400..."
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "event": "http.request.completed",
  "method": "GET",
  "path": "/orders/ORD-123",
  "status_code": 200,
  "duration_ms": 45.67,
  "request_id": "req_7f8b9c123"
}
```

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∞–º–∞:**
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å (method, path, IP)
- ‚úÖ –ò–∑–º–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç `request_id` –∏ `correlation_id` –≤ –∫–∞–∂–¥—ã–π –ª–æ–≥
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫-—Ç—Ä–µ–π—Å–æ–º

---

### 6Ô∏è‚É£ **Kafka –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî –õ–æ–≥–∏—Ä—É–µ–º –°–æ–æ–±—â–µ–Ω–∏—è**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
–°–µ—Ä–≤–∏—Å `Data Processor` –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Kafka, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ.

**–ë–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
```python
async def process_message(message):
    logger.info(f"Processing message: {message['value']}")
    # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞
```

‚ùå –ù–µ—Ç `correlation_id`, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—É—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è.

**–° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**
```python
from tradeforge_logger.middleware import KafkaContextMiddleware

middleware = KafkaContextMiddleware()

async def process_message(message):
    with middleware.context_from_message(message):
        logger.info("message.received", topic=message["topic"])
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞
        logger.info("message.processed")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "event": "message.received",
  "topic": "trade-forge.marketdata.candles.raw.v1",
  "correlation_id": "abc-123",  # –ò–∑–≤–ª–µ—á–µ–Ω –∏–∑ headers Kafka
  "request_id": "req_kafk4567"
}
```

**–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å:**
1. –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–∑ `moex_collector` —Å `correlation_id: abc-123`
2. –ü–æ–ª—É—á–µ–Ω–æ –≤ `data_processor` —Å —Ç–µ–º –∂–µ `correlation_id`
3. –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–∞–ª—å—à–µ

---

## üé® –ö—Ä–∞—Å–∏–≤—ã–µ –õ–æ–≥–∏ –¥–ª—è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**Production (JSON –¥–ª—è –º–∞—à–∏–Ω):**
```json
{"timestamp":"2025-10-20T14:23:45Z","level":"info","event":"order.created","service":"order-service","order_id":"ORD-123","amount":100.50}
```

**Development (Console –¥–ª—è –ª—é–¥–µ–π):**
```
2025-10-20 14:23:45.123 [INFO    ] order.created                    logger=order_service.handlers
    order_id: ORD-123
    amount: 100.50
    correlation_id: 550e8400-e29b-41d4-a716-446655440000
```

–° —Ü–≤–µ—Ç–∞–º–∏:
- üü¢ INFO ‚Äî –∑–µ–ª–µ–Ω—ã–π
- üü° WARNING ‚Äî –∂–µ–ª—Ç—ã–π
- üî¥ ERROR ‚Äî –∫—Ä–∞—Å–Ω—ã–π

---

## üî• –ö—Ä—É—Ç—ã–µ –§–∏—á–∏

### 1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –û—à–∏–±–æ–∫ —Å –ö–æ–Ω—Ç–µ–∫—Å—Ç–æ–º**

```python
try:
    result = process_payment(order)
except PaymentError as e:
    logger.error(
        "payment.failed",
        order_id=order.id,
        amount=order.amount,
        exc_info=True  # –î–æ–±–∞–≤–∏—Ç –ø–æ–ª–Ω—ã–π —Å—Ç–µ–∫-—Ç—Ä–µ–π—Å
    )
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "event": "payment.failed",
  "order_id": "ORD-123",
  "amount": 100.50,
  "exception": {
    "type": "PaymentError",
    "message": "Insufficient funds",
    "traceback": ["line 1", "line 2", "..."]
  }
}
```

### 2. **Performance –ú–µ—Ç—Ä–∏–∫–∏**

```python
import time

start = time.time()
result = heavy_computation()
duration_ms = (time.time() - start) * 1000

logger.info("computation.completed", duration_ms=round(duration_ms, 2))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{"event": "computation.completed", "duration_ms": 1523.45}
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
```bash
jq 'select(.duration_ms > 1000)' logs.json
```

### 3. **–£—Ä–æ–≤–Ω–∏ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**

```python
logger.debug("cache.hit", key="user_123")           # –î–µ—Ç–∞–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
logger.info("order.created", order_id="ORD-123")    # –í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
logger.warning("rate.limit.approaching", rate=95)   # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
logger.error("payment.failed", order_id="ORD-123")  # –û—à–∏–±–∫–∏
logger.critical("database.connection.lost")         # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
```

–í production:
```python
configure_logging(log_level="INFO")  # DEBUG –ª–æ–≥–∏ –Ω–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Ñ–∞–π–ª
```

---

## üìä –†–µ–∞–ª—å–Ω—ã–π –ö–µ–π—Å: –û—Ç–ª–∞–¥–∫–∞ –ü—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–∞–ª—É–µ—Ç—Å—è: "–Ø —Å–æ–∑–¥–∞–ª –∑–∞–∫–∞–∑, –Ω–æ –¥–µ–Ω—å–≥–∏ –Ω–µ —Å–ø–∏—Å–∞–ª–∏—Å—å!"

**–ë–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
üò´ –°–º–æ—Ç—Ä–∏—à—å –ª–æ–≥–∏ 5 —Å–µ—Ä–≤–∏—Å–æ–≤, –ø—ã—Ç–∞–µ—à—å—Å—è –Ω–∞–π—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏... –ó–∞–Ω–∏–º–∞–µ—Ç 2 —á–∞—Å–∞.

**–° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**

1. –ù–∞—Ö–æ–¥–∏—à—å `correlation_id` –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–Ω –≤ HTTP header –æ—Ç–≤–µ—Ç–∞)
2. –ò—â–µ—à—å –ø–æ –≤—Å–µ–º –ª–æ–≥–∞–º:
   ```bash
   grep "550e8400-e29b-41d4-a716-446655440000" logs/*.json
   ```
3. –í–∏–¥–∏—à—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å:
   ```json
   {"event": "order.creation.started", "correlation_id": "550e8400..."}
   {"event": "order.validated", "correlation_id": "550e8400..."}
   {"event": "payment.failed", "error": "Timeout", "correlation_id": "550e8400..."}
   ```

**–û—Ç–≤–µ—Ç –Ω–∞–π–¥–µ–Ω –∑–∞ 30 —Å–µ–∫—É–Ω–¥:** Payment —Å–µ—Ä–≤–∏—Å —É–ø–∞–ª –ø–æ —Ç–∞–π–º–∞—É—Ç—É! üéâ

---

## üèÜ –ò—Ç–æ–≥–æ: –ó–∞—á–µ–º –≠—Ç–æ –ù—É–∂–Ω–æ?

### –î–ª—è –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
- ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ (–Ω–µ –ø–∏—à–µ—à—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é)
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ª–∞–¥–∫–∞ (correlation_id)
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ —á–∏—Ç–∞–µ–º—ã–µ –ª–æ–≥–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### –î–ª—è DevOps:
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ ‚Üí –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å ELK, Grafana
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (duration_ms)
- ‚úÖ –í—Å–µ –ª–æ–≥–∏ –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

### –î–ª—è –ë–∏–∑–Ω–µ—Å–∞:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º = –¥–æ–≤–æ–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (sanitization)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (–º–æ–∂–µ–º —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –ª–æ–≥–∞–º)

---

## üöÄ –ù–∞—Å–∫–æ–ª—å–∫–æ –≠—Ç–æ –ö—Ä—É—Ç–æ?

**–ê–Ω–∞–ª–æ–≥–∏:**
- Python `logging` ‚Äî —Å—Ç–∞—Ä—ã–π, –Ω–µ—É–¥–æ–±–Ω—ã–π, –Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
- `loguru` ‚Äî —Ö–æ—Ä–æ—à–∏–π, –Ω–æ –Ω–µ—Ç –≥–æ—Ç–æ–≤–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å FastAPI/Kafka
- **`tradeforge_logger`** ‚Äî **–∑–∞—Ç–æ—á–µ–Ω –ø–æ–¥ Trade Forge**, –≥–æ—Ç–æ–≤ –∏–∑ –∫–æ—Ä–æ–±–∫–∏, production-ready! üí™

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë —É–Ω–∏–∫–∞–ª—å–Ω–æ–π:**
1. **–ì–æ—Ç–æ–≤—ã–µ middleware** –¥–ª—è FastAPI –∏ Kafka
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π correlation_id** —á–µ—Ä–µ–∑ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
3. **Sanitization** –∏–∑ –∫–æ—Ä–æ–±–∫–∏
4. **–î–≤–∞ —Ä–µ–∂–∏–º–∞** (JSON –¥–ª—è prod, Console –¥–ª—è dev)
5. **–ü–æ–ª–Ω–æ—Å—Ç—å—é type-safe** (100% –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤)

---

## üéØ –í—ã–≤–æ–¥

`tradeforge_logger` ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ". –≠—Ç–æ **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏**, –∫–æ—Ç–æ—Ä–∞—è:
- üîç –ü–æ–º–æ–≥–∞–µ—Ç **–±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã**
- üîí **–ó–∞—â–∏—â–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- üìä –î–∞–µ—Ç **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚ö° **–£—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É** (–º–µ–Ω—å—à–µ boilerplate)
- üåê **–°–≤—è–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã** —á–µ—Ä–µ–∑ correlation_id

**–≠—Ç–æ –∫–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ —Å –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞ –Ω–∞ Tesla ‚Äî —Ç—ã –¥–∞–∂–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—â–µ —Å—Ç–∞–Ω–µ—Ç –∂–∏–∑–Ω—å!** üöÄ
